【工作空间（Workspace）使用指南】

工作空间是智能体执行工作时的隔离文件系统环境，用于存放代码、文档、数据等文件。

## 核心概念

1) 路径隔离：只能访问工作空间内的文件，无法访问外部文件系统
2) 相对路径：所有文件操作必须使用相对路径（相对于工作空间根目录）
3) 工作空间内没有执行代码或者命令的权限，只有读写文件的权限，可能无法满足编程开发的需要。但目录可以作为静态HTTP服务，可以用户在浏览器里打开HTML文件。

## 可用工具

### read_file - 读取文件
```
read_file({ path: "src/main.js", offset: 0, length: 5000 })
```
返回：{ content: "文件内容" } 或 { error: "错误类型" }
- 支持分段读取大文件
- offset: 读取起始位置（字节/字符），默认为 0
- length: 读取长度，默认为 5000

### write_file - 写入文件
```
write_file({ path: "src/main.js", content: "代码内容", mimeType: "text/javascript" })
```
返回：{ ok: true, path: "src/main.js", size: 1024, mimeType: "text/javascript" } 或 { ok: false, error: "错误类型" }
- 父目录不存在时自动创建
- 文件已存在时覆盖
- mimeType 可选，未提供时自动检测（支持 text/javascript、application/json 等）

### list_files - 列出目录
```
list_files({ path: "src" })  // 或省略 path 列出根目录
```
返回：{ files: [{ name: "main.js", type: "file", size: 1024 }, ...] }

### get_workspace_info - 获取工作空间信息
```
get_workspace_info({})
```
返回：{ fileCount: 10, dirCount: 3, totalSize: 51200, lastModified: "2024-01-01T00:00:00Z" }

## 重要规则

1) 路径安全：
   - 必须使用相对路径，禁止使用绝对路径
   - 禁止使用 ".." 进行路径遍历
   - 违规操作会返回 "path_traversal_blocked" 错误

2) 常见错误：
   - workspace_not_assigned：未分配工作空间
   - file_not_found：文件不存在
   - permission_denied：权限不足
   - not_a_directory：路径不是目录

3) 最佳实践：
   - 先用 list_files 了解现有文件结构
   - 写入前确认路径正确
   - 用 get_workspace_info 检查空间使用情况


### 何时使用工作空间

当多个智能体需要协作完成系统性工作时，必须使用工作空间：
- 开发包含多个文件的项目（如网站、应用程序、协作编纂书籍或报告）
- 多个智能体分工协作（如：架构师设计接口、开发者实现代码、测试者编写测试）
- 需要相互引用的文件（如：代码引用配置文件、模块间相互依赖）
- 多智能体协作编写的多文件合集（如：分卷的书籍、课程）


### 协作示例

多智能体开发一个网站：
1) 架构师智能体：write_file("design/api.md", "接口设计...")
2) 前端智能体：read_file("design/api.md") → write_file("src/app.js", "前端代码...")
3) 后端智能体：read_file("design/api.md") → write_file("src/server.js", "后端代码...")
4) 测试智能体：read_file("src/*.js") → write_file("test/test.js", "测试代码...")

