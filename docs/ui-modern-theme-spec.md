# 智能体工作台颜色与交互视觉规范（自顶而下 · 风格引导版）

这是一份“规范”，用于指导色彩搭配、暗黑策略、交互反馈与组件层级，让任何人照着都能做出一致的界面。本文以视觉与交互最佳实践为主，具体实现细节仅作为落地参考。

## 1. 目标与设计原则

### 1.1 目标
- 统一整站视觉语言：组织侧栏、标签页、智能体列表、聊天、弹窗（工件/组织模板/插件/设置）风格一致。
- 简约现代：减少噪音（过强对比/过多边框/图标乱用），用清晰的层级、比例与留白建立秩序。
- 必要交互效果：hover/active/selected/focus/disabled/loading/error 空态一致。
- 支持清新明亮 + 清晰暗黑主题，并可扩展“跟随系统”。

### 1.2 设计原则（面向人）
- 中性色承载结构：页面结构主要靠背景/表面层级完成，不靠彩色大块铺底。
- 主色只做强强调：主色负责“主操作、选中、焦点”，其余颜色服从层级。
- 状态色克制使用：错误/警告/信息只在需要表达状态时出现，并限制面积。
- 对比度优先：可读性永远优先于“更酷”；弱信息也要清晰，不允许“发雾”。

### 1.3 视觉基调（推荐方向）
- 明亮主题：空气感 + 低饱和冷暖平衡（淡蓝灰底 + 白色表面），主色偏青绿/薄荷绿，整体“清新自然”。
- 暗黑主题：低对比背景 + 高可读正文（深蓝黑底 + 深靛表面），主色保持同一色相但降低刺眼感，整体“清晰不灰”。
- 强调色策略：以主色为唯一强强调，其余状态色控制饱和度与面积，避免“彩色大块”。

### 1.4 配色搭配规范（颜色如何组合）
- 三层结构：结构层（中性色）承载布局，强调层（主色/链接）引导操作，状态层（危险/警告/信息）仅表达状态。
- 推荐占比：中性色 80–90%，主色与链接 8–15%，状态色总量 0–5%。
- 选中态优先“弱底 + 细强调”：优先左侧条/下划线/小徽标，避免整块高饱和底色。
- 色温一致：整站选择一个中性基调（偏冷或偏暖），不要同屏混用两套灰（会显得拼贴）。

### 1.5 暗黑主题最佳实践（避免靠色与发雾）
- 不用纯黑铺底：背景应是深色而非纯黑，表面必须在背景上有可感知层级差。
- 不用透明白叠层做结构：尽量用深色表面层级表达结构，透明白只做极少量点缀。
- 弱信息不等于低可读：弱信息应更轻但仍清晰，避免“灰到看不见”的发雾。
- 选中态避免“彩底 + 白字”：优先深表面弱底 + 主色细条 + 正文色。

---

## 2. 信息架构与布局（不改功能，仅统一体验）

### 2.1 页面骨架
保持三段式结构：
- 左：组织全局侧栏（包含 4 个全局入口：设置/工件/组织模板/插件管理）
- 中：工作区（Tab strip + 当前 Tab 的智能体列表）
- 右：主内容（聊天视图 / 组织视图）

### 2.2 “窗口系统”（统一弹窗/浮窗）
工件管理器、组织模板、插件管理、设置模态统一遵循：
- 统一标题栏：标题 + 右侧操作按钮（最大化/还原、关闭；可选最小化）
- 统一容器：统一圆角、阴影、边框、背景与分割线
- 统一布局：窗口内容默认采用双栏（左列表、右详情）

---

## 3. 设计 Tokens（Light/Dark）

### 3.1 Tokens 组织方式
建议以 CSS 变量作为设计系统“单一真源”：
- 基础色（Base）
- 中性色阶（Neutral Scale）
- 语义色（Semantic：primary/danger/warning/info）
- 文本层级（Text）
- 表面层级（Surface）
- 线条与阴影（Border/Shadow）
- 尺度（Radius/Space/Font/Line-height）

> 说明：色值可微调，但需要保持：同一 token 在 Light/Dark 的语义一致、层级一致、对比度一致。

#### 3.1.1 命名规范（让“看名字就知道怎么用”）
- 只允许两类 token：
  - 基础色（Primitives）：描述“色阶”，不描述用途（例如 Neutral/Brand/Red 的阶梯）。
  - 语义色（Semantics）：描述“用途”，不描述具体色相（例如 bg/surface/text/border/selected）。
- 命名要求：
  - 语义 token 不出现具体色相词（禁止 green/blue/red 等），只出现用途词。
  - 同一语义在 Light/Dark 必须表达同一含义，只调整强度，不改变用途。

#### 3.1.2 Primitives（基础色）推荐结构
- Neutral（中性色阶）：N0–N12（或 N0–N16），用于背景/表面/分割线/文字灰阶。
- Brand（主色阶）：B0–B9，用于主操作/选中/焦点的强度变化。
- Intent（状态色阶）：Danger/Warning/Info/Success 各自 0–9，用于状态表达的强度变化。

#### 3.1.3 Semantics（语义色）推荐结构
- Background/Surface
  - `bg`：页面底（最外层）
  - `surface-1`：主要内容表面（聊天、卡片、窗口内容）
  - `surface-2`：次级表面（侧栏、分组底）
  - `surface-3`：交互表面（hover、弱选中、分段底）
- Text
  - `text-1`：正文/标题（主要阅读）
  - `text-2`：次文本（元信息、说明）
  - `text-3`：弱信息（时间戳、注释、占位符）
  - `on-primary`：主色背景上的文字（尽量少用）
- Border/Overlay/Focus
  - `border`：分割线/描边（克制但清晰）
  - `overlay`：模态遮罩
  - `focus`：统一 focus ring
- Selection/Interaction
  - `selected`：选中弱底（注意：暗黑主题优先弱底 + 细强调，避免彩底白字）
  - `link`：链接（与主色分工，避免同屏争夺焦点）
- Intent（状态语义）
  - `danger` / `warning` / `info` / `success`：仅表达状态，不承担结构层级

##### 3.1.3.1 语义 tokens 最小集（必须具备）
这套最小集保证：任何页面都能仅靠语义表达结构、文本层级、交互反馈，不需要引入“自定义灰/自定义绿”。

- 结构层（必须）：`bg`、`surface-1`、`surface-2`、`surface-3`
- 文本层级（必须）：`text-1`、`text-2`、`text-3`
- 边界与聚焦（必须）：`border`、`overlay`、`focus`
- 交互（必须）：`selected`、`link`、`primary`（主色本身属于强调层的必需项）
- 状态（建议最小）：`danger`、`warning`、`info`、`success`（至少要有 danger）

补充建议（用于“不得不用强底”的少数场景）：
- `on-primary`（以及 `on-danger/on-warning/on-info/on-success`）：用于小面积高强调（例如 badge/toast），不用于长段正文。

##### 3.1.3.2 Intent 三件套（推荐：fg/bg/border）
为了彻底避免“彩底白字靠色”和“错误提示一片红”这类问题，状态语义建议拆成三件套：
- `intent-*-fg`：状态前景（文字/图标）
- `intent-*-bg`：状态弱底（背景，默认弱）
- `intent-*-border`：状态描边（细条/边框）

使用规则：
- 默认只用 `intent-*-fg` + `intent-*-border` 做点缀（小图标、细条、描边），弱底 `intent-*-bg` 只在卡片/提示条这种“需要聚焦”场景使用。
- 禁止：用 intent 背景铺满大块区域当结构色；结构只能由中性色体系负责。
 
##### 3.1.3.3 语义 token 清单（可实施版本）
文档中 token 名称省略 `--` 前缀；实现时统一落为 CSS 变量（例如 `bg` → `--bg`）。

必须实现（全站最小集）：
| 分组 | Token | 用途 | 禁止用法 |
|---|---|---|---|
| 结构 | `bg` | 页面最外层背景 | 用彩色/状态色当结构底 |
| 结构 | `surface-1` | 主内容表面（卡片、聊天、窗口内容） | 用透明叠层替代表面层级 |
| 结构 | `surface-2` | 次表面（侧栏、分组底、header/footer） | 随意新增“自定义灰” |
| 结构 | `surface-3` | 交互表面（hover/弱选中/分段底） | 用主色大面积铺底做 hover |
| 文本 | `text-1` | 正文/标题（主阅读） | 在浅底使用白字；在深底使用黑字 |
| 文本 | `text-2` | 次文本（元信息、说明） | 用透明白当次文本 |
| 文本 | `text-3` | 弱信息（时间戳、注释、placeholder） | 弱到“发雾”不可读 |
| 边界 | `border` | 分割线/描边（轻且清晰） | 用粗重边框当层级 |
| 聚焦 | `focus` | focus ring（统一） | 用颜色堆砌焦点（多色/多重阴影） |
| 遮罩 | `overlay` | 模态遮罩 | 遮罩当背景层级使用 |
| 强调 | `primary` | 主操作/选中标记/焦点主色 | 作为大面积结构底 |
| 交互 | `selected` | 选中弱底（配合细强调） | 选中态用彩底白字承载长内容 |
| 交互 | `link` | 链接色（与主色分工） | 链接色与主色同强度抢焦点 |

状态（至少具备 danger；推荐四套齐全）：
| Intent | 前景 | 弱底 | 描边 |
|---|---|---|---|
| danger | `intent-danger-fg` | `intent-danger-bg` | `intent-danger-border` |
| warning | `intent-warning-fg` | `intent-warning-bg` | `intent-warning-border` |
| info | `intent-info-fg` | `intent-info-bg` | `intent-info-border` |
| success | `intent-success-fg` | `intent-success-bg` | `intent-success-border` |

可选（仅用于小面积强强调场景）：
| 场景 | Token | 说明 |
|---|---|---|
| 主色强底 | `on-primary` | 主色实心底上的文字/图标；不用于长段正文 |
| 状态强底 | `intent-*-solid` / `on-intent-*` | badge/toast/极少量强提示；默认不用在主体内容区 |


#### 3.1.4 语义映射规则（从“规范”到“页面上所有颜色”）
- 页面上出现的每一种颜色，必须回答它的语义归属：结构层/强调层/状态层之一。
- 任何组件不得新增“自定义灰”或“自定义绿”，只能在既有语义 token 里选：否则必然走向割裂。
- 如果遇到“同一语义需要两种强度”，优先扩展语义层级（例如新增 `surface-4`），不要用彩色解决结构问题。

### 3.2 字体与 Web 兼容性（必须统一）
推荐字体栈（兼顾中英文、跨平台一致性）：
- UI 正文：`ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Noto Sans CJK SC", "Source Han Sans SC", sans-serif`
- 等宽（代码/JSON/日志）：`ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace`

排版建议：
- 默认字号：14px（桌面 Web 视角最稳）
- 关键标题：16–18px（少而精）
- 弱信息：12–13px（时间戳、辅助说明）
- 字重：400/500/600 三档即可，避免 700+ 大面积使用
- 行高：正文 1.5；列表/标签 1.35；代码 1.55

### 3.3 颜色 Tokens（理想推荐值）

#### 3.3.1 中性色阶（建议以 0–12 表示层级）
明亮（Light Neutral）建议：
- N0 `#FFFFFF`（纯白表面）
- N1 `#F7F8FB`（页面底）
- N2 `#EEF2F7`（次级底/分组底）
- N3 `#E5EAF2`（浅分割线/卡片描边）
- N8 `#475569`（次文本）
- N10 `#1F2937`（主文本）
- N12 `#0F172A`（标题/强调文本）

暗黑（Dark Neutral）建议：
- N0 `#0B0F17`（页面底）
- N1 `#0F172A`（次级底）
- N2 `#111C2E`（表面 2）
- N3 `#16233A`（表面 1）
- N6 `#2A3A55`（分割线/描边）
- N10 `#D1D5DB`（主文本）
- N12 `#EEF2F7`（标题/高亮文本）

#### 3.3.2 语义色（主色与状态色）
主色（Primary）建议：
- Light：`#22C55E`（清新但不过亮的绿）或略偏青 `#16B981`
- Dark：同色相，但避免荧光感，建议 `#2DD36F` 或 `#22C55E` 配合更深的弱底

状态色建议（同一色相在 Light/Dark 保持一致，亮度按主题调整）：
- Danger：Light `#EF4444` / Dark `#F87171`
- Warning：Light `#F59E0B` / Dark `#FBBF24`
- Info：Light `#3B82F6` / Dark `#60A5FA`

#### 3.3.3 最终 Tokens 表（建议实现时直接落为变量）

明亮主题（Light）
| Token | 值 | 用途 |
|---|---|---|
| `--bg` | `#F7F8FB` | 页面背景（空气感底色） |
| `--surface-1` | `#FFFFFF` | 主表面（卡片/聊天区域/窗口内容） |
| `--surface-2` | `#EEF2F7` | 次表面（侧栏、分组底） |
| `--surface-3` | `#E8EDF6` | hover/选中弱底（中性） |
| `--text-1` | `#0F172A` | 主文本 |
| `--text-2` | `#475569` | 次文本 |
| `--text-3` | `#94A3B8` | 弱信息（时间戳、注释） |
| `--border` | `rgba(15,23,42,.10)` | 边框/分割线（更轻） |
| `--primary` | `#16B981` | 主色（偏青绿，更清新） |
| `--primary-weak` | `rgba(22,185,129,.14)` | 主色弱底（选中/气泡） |
| `--link` | `#2563EB` | 链接（不与主色抢戏） |
| `--focus` | `rgba(22,185,129,.45)` | focus ring |
| `--danger` | `#EF4444` | 错误/删除 |
| `--warning` | `#F59E0B` | 警告 |
| `--info` | `#3B82F6` | 信息 |
| `--overlay` | `rgba(15,23,42,.35)` | 模态遮罩 |

黑暗主题（Dark）
| Token | 值 | 用途 |
|---|---|---|
| `--bg` | `#0B0F17` | 页面背景（深蓝黑） |
| `--surface-1` | `#111C2E` | 主表面（避免发灰） |
| `--surface-2` | `#0F172A` | 次表面 |
| `--surface-3` | `#16233A` | hover/选中弱底（中性） |
| `--text-1` | `#EEF2F7` | 主文本（更清晰） |
| `--text-2` | `#C7D2E1` | 次文本（不要过灰） |
| `--text-3` | `#7C8AA3` | 弱信息 |
| `--border` | `rgba(238,242,247,.10)` | 边框/分割线 |
| `--primary` | `#2DD36F` | 主色（暗黑下更清晰但不荧光） |
| `--primary-weak` | `rgba(45,211,111,.16)` | 主色弱底 |
| `--link` | `#60A5FA` | 链接 |
| `--focus` | `rgba(45,211,111,.50)` | focus ring |
| `--danger` | `#F87171` | 错误/删除 |
| `--warning` | `#FBBF24` | 警告 |
| `--info` | `#60A5FA` | 信息 |
| `--overlay` | `rgba(0,0,0,.45)` | 模态遮罩 |

### 3.4 对比度与用色规则（确保“清晰 + 舒适”）
- 文本对比度：正文 ≥ 4.5:1；弱信息 ≥ 3:1；按钮文本永远以可读为先。
- 主色面积：主色用于“操作与选中”，避免大面积主色背景占据页面主体。
- 边框策略：默认用轻 border；只有在密集列表/表格才加明显分割线。
- 暗黑模式禁忌：不要用纯黑 `#000` 大面积铺底；弱文字不要用过浅灰（会“发雾”）。
- 彩色禁忌：状态色只用于状态点缀（badge/左侧条/小图标），不用于大块背景。

### 3.5 尺度 Tokens（全局统一）
| Token | 推荐值 | 说明 |
|---|---:|---|
| `--r-sm` | `8px` | 小圆角（按钮、小卡片） |
| `--r-md` | `12px` | 中圆角（面板、输入框） |
| `--r-lg` | `16px` | 大圆角（浮窗） |
| `--space-1..6` | `4/8/12/16/20/24px` | 只用这几档，避免“乱飘” |
| `--font-12/13/14/16/18` | 12–18px | 字号阶梯 |
| `--lh-body` | `1.5` | 正文行高 |
| `--lh-list` | `1.35` | 列表行高 |

### 3.6 阴影 Tokens（层级，建议实现时给出明确值）
- `--shadow-1`：轻（卡片 hover/选中，几乎不可察但提升质感）
- `--shadow-2`：中（模态/浮窗默认，清晰但不“厚重”）
- `--shadow-3`：重（聚焦窗口/拖拽/最大化，表现层级顶点）

---

## 4. 核心组件规范（统一外观 + 状态）

本章用“配方”描述组件：先规定结构与信息层级，再规定用色逻辑，最后规定状态反馈强度。目标是让同类组件在任何页面/弹窗里都长得一样、反馈一样。

### 4.1 Button（按钮体系）
统一 4 类：
- Primary：主操作（使用 `--primary`）
- Secondary：次操作（中性表面 + 边框）
- Ghost/IconButton：图标按钮（透明底 + hover 表面）
- Danger：删除/终止

统一状态矩阵（所有按钮必须具备）：
- default / hover / active / focus / disabled / loading

交互细则：
- hover：背景轻微变化 + 指针
- active：下压 1px（或轻微缩放 0.98）+ 取消过强阴影
- focus：2px 主色 focus ring（可访问性必需）

禁忌：
- 不用大面积纯主色铺底来表达“可点击”，主色只服务“主操作”。
- 不用低对比文字（例如浅色按钮上用浅灰字），按钮文本必须清晰可读。

错误示例（常见）：
- Primary 与 Secondary 的视觉强度相同，导致用户不知道“哪个是主操作”。
- hover 同时改背景、改字色、改阴影，造成闪烁与噪音。
- Danger 按钮用大块纯红底到处出现，页面充满“警报感”。

纠正方式：
- 强度分层：Primary 只保留一个主入口，其余都降级为 Secondary/Ghost。
- 反馈克制：hover 优先只提升表面/亮度，active 只做短促下压。
- 危险色收敛：danger 先用于文字/细条/描边，仅在必要时使用强底。

### 4.2 List Item（列表项：组织/智能体/插件）
统一结构：
- 左：图标/头像（统一圆角方块或圆形，二选一）
- 中：标题 + 次描述
- 右：状态/计数/快捷动作（hover 才显示）

状态：
- default：透明或 surface
- hover：`surface-1`/轻高亮
- selected：`primary-weak` 背景 + 左侧 2px 主色条（或顶部标记）
- disabled：降低对比度 + 禁用指针

禁忌：
- 浅灰底上使用白字；暗黑主题里用彩色底 + 白字做选中态（容易靠色、刺眼）。
- 用不同形态表达同一语义（例如一个列表选中是整块彩底，另一个是边框），会造成割裂。

错误示例（常见）：
- 选中态用“高饱和底色 + 白字”硬拉对比，导致靠色与疲劳。
- 列表 hover 用彩色，选中用另一种彩色，信息层级全靠颜色堆出来。
- 同屏里两个列表组件的选中态不同（一个左条，一个描边），像拼装界面。

纠正方式：
- 选中逻辑固定为“弱底 + 细强调 + 正文色文本”，不靠白字抬对比。
- 结构优先：背景层级由 surface 负责，彩色仅作小面积标识。
- 同类同规：同类型列表必须共享一套状态矩阵与间距基线。

### 4.3 Tab（标签页）
建议胶囊风格（现代产品一致性好）：
- 未选中：透明底 + `text-2`
- hover：`surface-1`
- 选中：`surface-1` + `shadow-1` + `text-1`
- close：仅在 hover/选中态出现，减少噪音

禁忌：
- 同一屏里出现两套 Tab 视觉（一个胶囊，一个矩形）或两套选中表达（下划线 vs 实心块）。

错误示例（常见）：
- Tab 选中态用实心彩底，导致与列表/按钮争夺主色焦点。
- close 按钮常驻显示，满屏叉号造成噪音与误点风险。

纠正方式：
- 选中态用“表面提升 + 细强调（下划线/细条）”，主色只负责标记。
- close 只在 hover/选中态出现，并保持点击热区一致。

### 4.4 Chat（聊天）
目标：保留微信“左右气泡”的可读性，但让“工具/思考/工件”呈现更产品化。

消息气泡：
- 我方（user）：`primary-weak` 背景（dark 下也保持弱底）+ 文本 `text-1`
- 对方：`surface-1` 气泡
- 气泡圆角统一 `--r-md`，间距统一 `--space-*`

“思考过程 / 工具调用 / 工件卡片”统一为 Card（可折叠）：
- Header：标题 + 状态 badge（running/success/error）+ 折叠箭头
- Body：内容区域（必要时等宽字体），提供复制按钮
- 默认折叠（减少信息噪音），但要有清晰提示“可展开”

禁忌：
- 用颜色堆信息层级：聊天是内容密集区，层级应优先靠留白、分组与轻边界完成。
- 暗黑主题里使用高饱和大块彩色气泡作为主体（长时间观看会疲劳且易靠色）。

错误示例（常见）：
- 我方气泡用“主色实心底 + 白字”承载长段正文，暗黑主题尤其刺眼。
- 工具/思考/工件各用一套颜色，聊天区像贴了多张卡片广告。
- 用浅灰弱字显示正文，导致“发雾”看不清。

纠正方式：
- 长内容优先用中性表面承载，主色用于细条/小徽标表达归属。
- 卡片体系统一：同一种信息模块必须共享同一套 Card 配方。
- 文本三档固定：正文永远用 `text-1`，弱信息用 `text-3`，不靠透明白。

### 4.5 Window（浮窗/管理器）
统一为 Window 组件：
- Header：标题 + actions（最大化/还原、关闭）
- Body：双栏布局（左列表 + 右详情）
- 分割线：统一用 `--border`
- 窗口层级：所有窗口 z-index 统一规划（避免互相盖错）

禁忌：
- 标题栏/关闭按钮在不同窗口里形态不同，会强烈破坏“系统感”。

错误示例（常见）：
- 一个窗口标题栏深色、另一个浅色；按钮悬浮风格也不同，造成割裂。
- 为了“更明显”，把窗口边框加粗加亮，结果噪音更大。

纠正方式：
- 统一标题栏与操作区：同一套背景、分割线、按钮形态与 hover 语义。
- 层级用 shadow：窗口聚焦来自阴影与遮罩，不靠粗边框抢戏。

### 4.6 Modal（模态：设置、错误）
统一规范：
- overlay：`rgba(0,0,0,.35)`（dark 下可略浅）
- content：`surface-1` + `shadow-2` + `r-lg`
- 表单：输入高度统一 36/40px；focus ring 统一

禁忌：
- 错误弹窗使用强烈红渐变大块背景作为主体，会过度惊吓且影响可读性；错误只需要“明确、可操作”。 

错误示例（常见）：
- error 模态用大块红底 + 白字，用户看见“紧张”，但读不清内容。
- overlay 过深或过浅，导致要么压迫要么失焦。

纠正方式：
- 错误以结构清晰为先：正文用中性表面，危险色只做标题标识/左条/按钮 hover。
- 遮罩只为聚焦服务：overlay 强度在明暗主题都要“可感知但不压迫”。 

### 4.7 状态语义矩阵（全站统一）
- hover：提示“可交互”，优先只改变背景/描边，避免改文字色。
- active：短促反馈（轻微下压或亮度变化），不闪烁、不抖动。
- selected：表示“当前上下文”，用弱底 + 细强调；文字仍使用正文色，不用白字。
- focus-visible：键盘可达性专用，用统一 focus ring，不与 selected 竞争。
- disabled：降低对比度但仍可读；不使用主色/危险色。

### 4.8 核心组件状态矩阵与用色表（推荐默认）

本节把抽象规则落为“表格”，用于设计评审与实现对照。表格只使用语义 token，不出现具体色值。

#### 4.8.1 Button（按钮）
| Variant | State | 背景 | 文字/图标 | 边界 | 强调/补充 |
|---|---|---|---|---|---|
| Primary | default | `primary` | `on-primary` | 透明或轻 `border` | 主操作仅此一类 |
| Primary | hover | `primary`（微提升） | `on-primary` | 透明或轻 `border` | 不改变文字色 |
| Primary | active | `primary`（微压暗） | `on-primary` | 透明或轻 `border` | 允许轻下压 |
| Primary | focus-visible | `primary` | `on-primary` | 透明或轻 `border` | `focus` ring |
| Secondary | default | `surface-1` | `text-1` | `border` | 次操作不抢戏 |
| Secondary | hover | `surface-3` | `text-1` | `border` | 只提升表面 |
| Ghost/Icon | default | 透明 | `text-2` | 透明 | |
| Ghost/Icon | hover | `surface-3` | `text-1` | 透明或 `border` | |
| Danger | default | 透明或 `surface-1` | `danger` | `border` | 危险色优先用于文字/细条 |
| Danger | hover | `surface-3` | `danger` | `border` | 禁止大块红底吓人 |
| Any | disabled | `surface-2` | `text-3` | `border` | 仍可读、不可点 |

#### 4.8.2 List Item（列表项：组织/智能体/插件）
| State | 背景 | 标题 | 次文本 | 分割线/边界 | 选中标记 |
|---|---|---|---|---|---|
| default | 透明或 `surface-2` | `text-1` | `text-3` | `border`（可选） | 无 |
| hover | `surface-3` | `text-1` | `text-2` | `border` | 无 |
| selected | `selected`（弱底） | `text-1` | `text-2` | `border` | `primary` 细条（左侧/顶部） |
| disabled | `surface-2` | `text-2` | `text-3` | `border` | 无 |

规则：
- selected 的文本永远回到 `text-1`/`text-2`，禁止用白字去“硬抬对比度”。
- 细强调（左条/下划线）承担“定位”，弱底承担“归属”，两者缺一不可。

#### 4.8.3 Tab（标签页）
| State | 背景 | 文字 | 边界 | 选中标记 |
|---|---|---|---|---|
| default | 透明 | `text-2` | 透明 | 无 |
| hover | `surface-3` | `text-1` | 透明或轻 `border` | 无 |
| selected | `surface-1` | `text-1` | `border` | 下划线/细条使用 `primary` |
| disabled | 透明 | `text-3` | 透明 | 无 |

#### 4.8.4 Chat Bubble（聊天气泡）
| Role | 背景 | 文字 | 边界 | 备注 |
|---|---|---|---|---|
| user（我方） | `surface-1` 或 `selected`（弱底） | `text-1` | `border` 或 `primary` 细条 | 禁止“绿底白字”做长段内容 |
| agent（对方） | `surface-1` | `text-1` | `border` | |

#### 4.8.5 Card（工具/思考/工件/附件）
| 区域 | 背景 | 标题 | 正文 | 边界 |
|---|---|---|---|---|
| 容器 | `surface-1` | `text-1` | `text-1` | `border` |
| Header | `surface-2` | `text-1` | `text-2` | `border`（下边） |
| Footer（可选） | `surface-2` | `text-2` | `text-2` | `border`（上边） |

#### 4.8.6 Modal / Window（模态与窗口）
| 部位 | 背景 | 文字 | 边界 | 备注 |
|---|---|---|---|---|
| overlay | `overlay` | - | - | 遮罩只做聚焦，不做强存在感 |
| container | `surface-1` | `text-1` | `border` | 阴影来自 elevation（不靠描边加粗） |
| header | `surface-2` | `text-1` | `border`（下边） | |
| close（默认） | `surface-2` | `text-2` | `border` | |
| close（hover） | `danger` | `on-primary` 或白字 | `danger`（弱边） | 危险色只在 hover 出现 |

#### 4.8.7 Input（输入框）
| State | 背景 | 文字 | placeholder | 边界 | 备注 |
|---|---|---|---|---|---|
| default | `surface-1` | `text-1` | `text-3` | `border` | |
| hover | `surface-1` | `text-1` | `text-3` | `border`（略提升） | |
| focus-visible | `surface-1` | `text-1` | `text-3` | `border` | `focus` ring |
| error | `surface-1` | `text-1` | `text-3` | `danger`（边界/提示） | 错误不铺红底 |

---

## 5. 动效与反馈（必要且克制）

统一动效参数：
- duration：150–200ms
- easing：`cubic-bezier(0.2, 0, 0, 1)`

推荐使用场景：
- hover/active/focus 的轻反馈
- 折叠展开（高度 + 透明度）
- 列表加载 Skeleton（替代“加载中...”纯文字）

禁止/避免：
- 连续循环动画（除非明确表示 loading）
- 大幅位移动画（影响阅读与效率）

---

## 6. 可访问性与可用性（必须达标）
- 对比度：正文至少 4.5:1；弱化文字至少 3:1。
- Focus：所有可交互元素必须有可见 focus ring。
- 点击热区：IconButton 最小 32×32；列表项高度建议 ≥ 44px。
- 键盘：Tab 可遍历主要操作；Esc 关闭模态/窗口（与现有行为保持一致）。

---

## 7. 主题切换策略

### 7.1 切换方式
- `data-theme="light|dark|system"`（推荐）
- system 使用 `prefers-color-scheme` 自动选择

### 7.2 落地规则
- 只允许使用 tokens；禁止组件写死颜色。
- legacy/v2 的样式冲突，靠“命名空间或层级（CSS Layer）”解决，保证覆盖关系稳定。

---

## 8. 现状问题与收敛策略（用于实现阶段的指导）

### 8.1 现状主要问题
- 两套 CSS 并存且同名选择器冲突（按钮、窗口、toast、chat 等），导致风格割裂。
- 同一页面内同时出现“深色侧栏 + 浅色聊天 + 深色浮窗”的混搭，缺少统一层级与色板。

### 8.2 收敛路径（实现阶段）
1) 先建立 tokens + 基础组件规范（Button/Window/Modal/List/Tab/Input/Badge）。
2) 给 v2 布局与 legacy 组件加“可控覆盖层级”（CSS Layer 或命名空间）。
3) 先统一结构性组件：侧栏、tab、列表（视觉稳定后再统一聊天细节）。
4) 最后统一窗口类（工件/模板/插件）与表单模态（设置）。

---

## 9. 验收清单（你可以用来验收实现）
- 主题：明亮/黑暗切换后，页面主结构与所有窗口/模态均一致变更，无“局部还停留在另一个主题”的情况。
- 组件一致性：按钮、列表项、tab、窗口标题栏、分割线在所有模块中完全一致。
- 交互一致性：hover/active/focus/disabled/loading 表现一致。
- 可读性：聊天区、工具/思考/工件区域的层级清晰，默认不干扰阅读。
- 细节：对齐/间距统一，无明显“圆角不同/字体不同/阴影不同”的割裂感。

---

## 10. 风格引导与最佳实践（Do / Don’t）

### 10.1 快速自检（能立刻提升一致性）
- 同一屏里是否只存在一套选中态表达？
- 正文、次文本、弱信息是否保持三档清晰分离？
- 主色是否只用于主操作/选中标记/焦点，而不是铺满背景？
- 暗黑主题是否避免了“透明白叠层导致发雾”与“彩底白字导致靠色”？ 

### 10.2 常见问题与处理方式
- 靠色：浅底白字、彩底白字、暗底黑字 → 正文永远用正文色体系，彩色只做点缀与边界。
- 发雾：弱信息用过浅灰或透明白叠加 → 用弱文字 token，不用透明白叠层当文字。
- 割裂：同类控件在不同窗口里不同风格 → 用组件配方锁定结构与状态语义。
- 过度强调：满屏主色与彩色按钮 → 先用中性色做结构，再用主色点睛。

---

## 11. 颜色盘点与收敛方法（实现阶段）

### 11.1 颜色盘点（Inventory）
- 统计当前所有色值（hex/rgb/rgba），按用途分组：背景/表面/文本/边界/状态/阴影。
- 为每组选择唯一语义 token，并建立对照表（旧色 → 语义），避免一类语义出现多种颜色。

### 11.2 迁移顺序（自顶而下）
1) 结构性组件：侧栏、Tab、列表（先把阅读路径做对）。
2) 内容区：聊天（气泡、内容卡片体系）。
3) 窗口与模态：工件/模板/插件/设置。
4) 模块面板：chrome/ssh/ffmpeg 等。

### 11.3 守门规则
- 禁止新增硬编码颜色：新增样式只能引用 tokens。
- 每次迁移必须自检：明/暗主题均通过验收清单，且无靠色。

---

## 12. 规范模板（写规范时怎么写）

### 12.1 新增/改造组件的规范模板
- 组件名称：
- 使用场景（一句话）：
- 信息层级（标题/正文/辅助）：
- 状态（必须覆盖）：default / hover / active / selected / focus-visible / disabled / loading / error
- 用色（只填语义，不填色值）：
  - 背景：
  - 文字：
  - 描边/分割线：
  - 强调（主色细条/下划线/徽标）：
  - 状态色（如有）：
- 暗黑主题说明（是否需要降低饱和度/缩小面积）：
- 禁忌（至少写 2 条，避免复发）：

### 12.2 页面级规范模板
- 页面名称：
- 主结构层级：bg / surface-1 / surface-2 / surface-3 的分配原则
- 主要组件清单（组件配方引用）：
- 强调色占比控制（主色/链接/状态色）：
- 暗黑主题风险点（靠色、发雾、刺眼）与处理策略：

---

## 13. 设计评审检查清单（颜色与交互）

### 13.1 颜色与层级
- 是否所有颜色都能归类为：结构层/强调层/状态层？
- 是否出现“浅灰底白字 / 深底黑字 / 彩底白字”的靠色组合？
- 是否存在“同一语义多色值”的情况（例如不同模块各一套灰）？
- 是否用彩色解决了结构问题（例如用绿底当分组背景）？

### 13.2 交互与一致性
- hover 是否只提升表面而非大幅改字色？
- selected 是否遵循“弱底 + 细强调”，且文本仍用正文色？
- focus ring 是否统一可见，且不与 selected 冲突？
- disabled 是否仍可读、且不误导为可点击？

### 13.3 暗黑主题专项
- 弱文字是否“发雾”（透明白/过灰导致）？
- 主色/状态色在暗黑下是否过艳（刺眼）？
- 选中态是否出现彩底白字的靠色？
- 表面层级差是否足够（bg 与 surface 是否可感知分层）？

### 13.4 走查方法（最低成本）
- 把页面截图转灰度：层级是否仍清晰（结构主要靠明度差，而不是色相）？
- 只看 2 秒：能否立刻找到“当前选中”和“主操作”？
- 长段阅读 30 秒：是否出现刺眼彩块或文字发雾导致疲劳？
